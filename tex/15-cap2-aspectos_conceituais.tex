\chapter{Aspectos conceituais}
\label{CAP2}

A seguir serão explicados os conceitos fundamentais que possibilitam a execução deste trabalho. 

% apresentar conceitos empregados e revisao da literatura (parte toerica do trab)

\section{O padrão OBD-II}

Criado na década de 1990 para gerar controle sobre as emissões de gás carbônico dos carros\textsuperscript{[5]}, hoje define um protocolo padronizado para comunicar parâmetros internos do veículo. O padrão OBD-II foi uma extensão do padrão OBD-I, uniformizando esse tipo de conector em casos em geral, começando a ser adotado no Brasil a partir de 2010\textsuperscript{[4]}.

A comunicação é feita através de uma conexão física que normalmente pode ser encontrada abaixo do volante do motorista\textsuperscript{[5]}, conforme indicado pela figura \ref{fig:obd2_conn}. Nesse padrão de conexão e comunicação, é definida uma interface por onde parâmetros internos de um veículo podem ser monitorados.

As mensagens definidas pelo OBD-II têm cada uma um PID (\textit{Parameter ID}). O conjunto comum de PIDs de serviços que podem ser solicitados pela porta OBD-II e para que servem pode ser visto na tabela \ref{Tb:tab1}\textsuperscript{[3]}.

\input{tabelas/tab1}


É importante notar que os serviços do padrão OBD-II comuns a todos os carros sempre começam com o dígito zero (hexadecimal), por isso, serviços específicos de cada fabricante precisam começam a partir do código 0x10.

\begin{figure}[hp]
    \centering
    
    \includegraphics[]{figures/localizacao_obd2.png}
    
    \caption{Posição da porta OBD-II em um carro\textsuperscript{[5]}}
    
    \label{fig:obd2_conn}
\end{figure}

Os dados, que podem ser coletados de qualquer carro, são explicitados na tabela \ref{Tb:tab2}\textsuperscript{[3]}.





Embora não esteja explicitamente representado na tabela, os PIDs 0x00, 0x20, 0x40, etc., ou seja, a cada 32 valores de PID, possuem um parâmetro dedicado exclusivamente para indicar quais, dentre os PIDs subsequentes, são fornecidos pelo veículo em questão. Esses PIDs de marcação, por assim dizer, utilizam 4 \textit{bytes} para comunicar quais dos próximos PIDs estão disponíveis, utilizando cada \textit{bit} como uma \textit{flag} binária. 

Na figura \ref{fig:bitwise_obd2} é possível visualizar como esse processo é feito, usando como exemplo o valor \textit{0xBE1FA813} para representar os 4 \textit{bytes} oferecidos\textsuperscript{[3]}.

\begin{figure}[hp]
    \centering
    
    \includegraphics[scale=0.7]{figures/tabela_dados_disponiveis.png}
    
    \caption{Divisão bit a bit da mensagem OBD-II informando os serviços disponíveis\textsuperscript{[3]}}
    
    \label{fig:bitwise_obd2}
\end{figure}


A coleta de fato dos dados relevantes é feita por uma aplicação desenvolvida \textit{a priori} que, ao começo do projeto, já era capaz de comunicar-se corretamente com a interface OBD.

Essa aplicação acelerou a criação da infraestrutura proposta por este trabalho, uma vez que adiantou o primeiro passo da estratégia \textit{bottom-up} que permeou o projeto.

\input{tabelas/tab2}

\section{Transmissão de dados}

A implementação do \textit{Bluetooth} neste projeto proporciona uma solução eficaz para a comunicação entre a porta OBD do veículo e o \textit{smartphone} do motorista. 

% Essa escolha oferece uma conectividade sem fio e em tempo real com o aplicativo, simplificando a transmissão de dados.

A abordagem \textit{wireless} elimina a necessidade de cabos físicos, contribuindo para uma integração mais simplificada do sistema. A eficiência energética do \textit{Bluetooth} assegura uma transmissão de dados sem fio sem prejudicar significativamente o consumo de bateria do aparelho celular.

% Além disso, a transmissão \textit{Bluetooth} facilita a interação direta entre o sistema de geração de dados e os usuários, possibilitando a visualização em tempo real de informações de condução. Essa integração sem fio não apenas aprimora a experiência do usuário, mas também amplia as possibilidades de interatividade e controle, tornando o sistema mais acessível e fácil de usar.


 \begin{figure}[hp]
    \centering
    
    \includegraphics[scale=0.4]{figures/bluetooth.png}
    
    \caption{Logo do Bluetooth.}
    
\end{figure}

\section{Armazenamento em nuvem}
O Amazon Web Services\textsuperscript{[10]} (AWS) foi o serviço de nuvem escolhido para o armazenamento dos dados do projeto, destacando-se por suas vantagens em segurança, escalabilidade e praticidade. 

A AWS oferece uma infraestrutura robusta com elevados padrões de segurança, garantindo a proteção avançada dos dados, enquanto sua escalabilidade permite uma adaptação eficiente às crescentes demandas do projeto, mantendo a eficiência operacional. Essa escolha proporciona um ambiente de nuvem que atende às exigências do projeto e estabelece uma base sólida para o desenvolvimento futuro.

A base de dados escolhida usa MySQL e foi hospedada em uma instância RDS. Todas as informações coletadas através do aplicativo desenvolvido foram armazenadas nesse serviço.

% Informações, como localização, velocidade e aceleração, podem então ser usadas para geração de gráficos e métricas essenciais na avaliação do perfil do motorista.

A combinação do Amazon RDS com a base de dados MySQL oferece uma solução eficiente e escalável para o armazenamento de dados, atendendo às necessidades do projeto e garantindo alta disponibilidade e segurança dos dados.




% \begin{table}[]
% \begin{tabular}{lllll}
% \multicolumn{5}{c}{\textbf{resumo da estimativa}}                                       \\
%                        &  &                       &  &                                  \\
% \textbf{custo inicial} &  & \textbf{custo Mensal} &  & \textbf{Custo total em 12 meses} \\
%                        &  &                       &  &                                  \\
% 0.00 USD               &  & 14.71 USD             &  & 176.52 USD                       \\
%                        &  &                       &  &                                 
% \end{tabular}
% \end{table}


\input{tabelas/tab_custo_instancia}

% A região do Leste da Virgina é conhecida por ter uma alta densidade de \textit{data centers}. Isso resulta em eficiência operacional e redução de custos.

A instância escolhida para o RDS foi a \textbf{db.t3.micro}, pois ela é uma unidade de processamento adequada para cargas de trabalho leves e é comumente usada para ambientes de desenvolvimento, testes ou pequenas aplicações que não exigem muitos recursos.

Foi cogitado fazer uso de um RDS Proxy, que é um serviço que facilita a escalabilidade e a alta disponibilidade para as conexões de banco de dados, mas como este projeto trata-se de um protótipo, não houve preocupações quanto a grandes cargas de trabalho e essa decisão foi descartada. 

% Logo, essa opção não foi escolhida. 

% Ele ajuda a melhorar o desempenho e a segurança ao gerenciar as conexões entre seus aplicativos e instâncias de banco de dados RDS. 

% Isso é especialmente útil em ambientes onde há flutuações na carga de trabalho. 

Também não há necessidade de haver um ambiente de zona de disponibilidade múltipla para garantir escalabilidade, pois haveria custo adicional para o MVP. Por isso, a instância RDS foi configurada para o modo Single-AZ. E a capacidade de armazenamento foi limitada a 20 GiB.


% \begin{table}[]
% \begin{tabular}{|ll|}
% \hline
% \multicolumn{1}{|l|}{\textbf{Região}}                 & Virgínia     \\ \hline
% \multicolumn{1}{|l|}{}                                &              \\ \hline
% \multicolumn{2}{|c|}{\textbf{Especificação das instancias do MySQL}} \\ \hline
% \multicolumn{1}{|l|}{Quantidade de Instancias MYSQL}  & 1            \\ \hline
% \multicolumn{1}{|l|}{tipo da instancia}               & db.t3.micro  \\ \hline
% \multicolumn{1}{|l|}{vCPU}                            & 2            \\ \hline
% \multicolumn{1}{|l|}{Memória}                         & 1GiB         \\ \hline
% \end{tabular}
% \end{table}


\input{tabelas/tab_escolhas_instancia}