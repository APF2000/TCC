\chapter{Aspectos conceituais}
\label{CAP2}

A seguir serão explicados os conceitos fundamentais que possibilitam a execução deste trabalho. 

% apresentar conceitos empregados e revisao da literatura (parte toerica do trab)

\section{O padrão OBD-II}

Criado na década de 1990 para gerar controle sobre as emissões de gás carbônico dos carros\textsuperscript{[5]}, hoje define um protocolo padronizado para comunicar parâmetros internos do veículo.
    
O padrão OBD-II foi uma extensão do padrão OBD-I, uniformizando esse tipo de conector em casos em geral, começando a ser adotado no Brasil a partir de 2010\textsuperscript{[4]}.

A comunicação é feita através de uma conexão física que normalmente pode ser encontrada abaixo do volante do motorista\textsuperscript{[5]}, conforme indicado pela figura \ref{fig:obd2_conn}.

Nesse padrão de conexão e comunicação é definida uma interface por onde parâmetros internos a um carro podem ser monitorados.

As mensagens definidas pelo OBD-II têm cada uma um PID (\textit{Parameter ID}). O conjunto comum de PIDs de serviços que podem ser solicitados pela porta OBD-II e para que servem pode ser visto na tabela \ref{Tb:tab1}\textsuperscript{[3]}.

\input{tabelas/tab1}

É importante notar que os serviços do padrão OBD-II comuns a todos os carros sempre começam com o dígito zero (hexadecimal), por isso, serviços específicos de cada fabricante devem começam a partir do código 0x10.

\begin{figure}[hp]
    \centering
    
    \includegraphics[]{figures/localizacao_obd2.png}
    
    \caption{Posição da porta OBD-II em um carro\textsuperscript{[5]}}
    
    \label{fig:obd2_conn}
\end{figure}

Os dados que podem ser coletados de qualquer carro são explicitados na tabela \ref{Tb:tab2}\textsuperscript{[3]}.

\input{tabelas/tab2}

Interessante notar que, embora não esteja representado na tabela, os PIDs 0x00, 0x20, 0x40, etc, ou seja, a cada 32 valores de PID, existe um parâmetro apenas para indicar quais entre os PIDs seguintes são fornecidos por aquele carro.

Esses PIDs de marcação, por assim dizer, utilizam 4 bytes para comunicar quais dos próximos PIDs estão disponíveis, utilizando cada bit como uma \textit{flag} binária. 

Na figura \ref{fig:bitwise_obd2} é possível visualizar como esse processo é feito, usando como exemplo o valor \textit{0xBE1FA813} para representar os 4 bytes oferecidos\textsuperscript{[3]}.

\begin{figure}[hp]
    \centering
    
    \includegraphics[scale=0.7]{figures/tabela_dados_disponiveis.png}
    
    \caption{Divisão bit a bit da mensagem OBD-II informando os serviços disponíveis\textsuperscript{[3]}}
    
    \label{fig:bitwise_obd2}
\end{figure}

A coleta de fato dos dados relevantes será feita por uma aplicação desenvolvida \textit{a priori} que já é capaz de comunicar-se corretamente com a interface OBD.

Essa aplicação acelerará a criação da infraestrutura proposta por este trabalho, uma vez que pula o primeiro passo da estratégia \textit{bottom-up} que deverá permear o projeto.

\section{Transmissão de dados}

A implementação da transmissão \textit{Bluetooth} neste projeto de compilação de dados oferece uma solução eficaz para a comunicação entre os produtor e consumidor de dados. 

Ao utilizar essa tecnologia, os dados de rastreamento podem ser transmitidos de forma sem fio e em tempo real para dispositivos equipados com \textit{Bluetooth}, como \textit{smartphones}, que são o foco deste trabalho.

A abordagem \textit{wireless} proporciona uma conectividade mais flexível, eliminando a necessidade de cabos físicos e simplificando a integração do sistema. A baixa energia do \textit{Bluetooth} permite uma transmissão eficiente de dados, minimizando o impacto no consumo de bateria dos dispositivos móveis.

Além disso, a transmissão \textit{Bluetooth} possibilita a interação direta entre o sistema de geração e os usuários, permitindo a visualização em tempo real de informações de condução.

Essa integração sem fio não apenas aprimora a experiência do usuário, mas também amplia as possibilidades de interatividade e controle, tornando o sistema mais acessível e fácil de usar.

 \begin{figure}[hp]
    \centering
    
    \includegraphics[scale=0.4]{figures/bluetooth.png}
    
    \caption{Logo do Bluetooth.}
    
\end{figure}

\section{Armazenamento em nuvem}
Provedoras como a Amazon e a Azure (Microsoft) oferecem serviços de nuvem que podem ser usados para este projeto \textsuperscript{[10, 11]}. Neste trabalho, optou-se pelo serviço da AWS, uma vez que um dos integrantes do grupo já tinha familiaridade com o serviço.

A integração do aplicativo Android com o Amazon RDS (Relational Database Service) da AWS oferece uma solução eficiente e escalável para o armazenamento de dados. 

Utilizando o RDS, os dados coletados, como informações de localização, velocidade e aceleração, podem ser armazenados em bancos de dados relacionais, proporcionando alta disponibilidade, segurança e desempenho otimizado. 

A flexibilidade do Amazon RDS permite a escolha de diferentes motores de banco de dados, como MySQL, PostgreSQL, ou SQL Server, adequando-se às necessidades específicas do sistema.

Os usuários poderão transmitir informações para a nuvem a qualquer momento, desde que seus carros estejam ligados e conectados à internet. O volume de dados recebidos no sistema é, portanto, variável e por isso fez sentido que o serviço de nuvem contratado siga o modelo \textit{on-demand}. A figura \ref{figure:custo_aws_inicial} mostra o custo calculado no serviço da AWS RDS.

\begin{figure}[hp]
    \centering
    
    \includegraphics[scale=0.8]{figures/custo_aws_inicial.PNG}
    \caption{Custo da AWS.}
    \label{figure:custo_aws_inicial}
    
\end{figure}

A região do Leste da Virgina é conhecida por ter uma alta densidade de \textit{data centers}. Isso resulta em eficiência operacional e redução de custos.

A instância escolhida foi a \textbf{db.t3.micro}. Ela é uma instância de banco de dados pequena, sendo adequada para cargas de trabalho leves. Essa instância é comumente usada para ambientes de desenvolvimento, testes ou pequenas aplicações que não exigem muitos recursos.

Um RDS Proxy é um serviço que facilita a escalabilidade e a alta disponibilidade para as conexões de banco de dados. Ele ajuda a melhorar o desempenho e a segurança ao gerenciar as conexões entre seus aplicativos e instâncias de banco de dados RDS. Isso é especialmente útil em ambientes onde há flutuações na carga de trabalho. Como se trata de um protótipo, não há preocupações com carga de trabalho. Logo, essa opção não foi escolhida.

Também não há necessidade de ter um ambiente de zona de disponibilidade múltipla para garantir escalabilidade, pois haveria custo adicional. Por isso, a instância RDS foi configurada para o modo Single-AZ. E a capacidade de armazenamento foi 20 GB.


\begin{table}[]
\begin{tabular}{|ll|}
\hline
\multicolumn{1}{|l|}{\textbf{Região}}                 & Virgínia     \\ \hline
\multicolumn{1}{|l|}{}                                &              \\ \hline
\multicolumn{2}{|c|}{\textbf{Especificação das instancias do MySQL}} \\ \hline
\multicolumn{1}{|l|}{Quantidade de Instancias MYSQL}  & 1            \\ \hline
\multicolumn{1}{|l|}{tipo da instancia}               & db.t3.micro  \\ \hline
\multicolumn{1}{|l|}{vCPU}                            & 2            \\ \hline
\multicolumn{1}{|l|}{Memória}                         & 1GiB         \\ \hline
\end{tabular}
\end{table}